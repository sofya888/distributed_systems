# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Python –∏ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á "–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ" –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è I/O-–æ–ø–µ—Ä–∞—Ü–∏–π (—Å–µ—Ç—å, —Ñ–∞–π–ª—ã, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö).

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- **async/await** - –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **Event Loop** - —Ü–∏–∫–ª —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- **Coroutine** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- **Task** - –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –∫–æ—Ä—É—Ç–∏–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –µ—ë –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ üêç

–î–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º —ç—Ç–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –∞–Ω–∞–ª–æ–≥–∏—è—Ö –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏!

## üéØ Async/Await - "–ü–æ–≤–∞—Ä –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ"

### –ê–Ω–∞–ª–æ–≥–∏—è:
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ **–ø–æ–≤–∞—Ä–∞** –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ, –∫–æ—Ç–æ—Ä—ã–π –≥–æ—Ç–æ–≤–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–ª—é–¥ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

```python
# –°–ò–ù–•–†–û–ù–ù–´–ô –ø–æ–≤–∞—Ä (–ø–ª–æ—Ö–æ–π)
def sync_chef():
    print("ü•ò –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É–ø")
    time.sleep(10)  # –ñ–¥–µ—Ç 10 —Å–µ–∫—É–Ω–¥ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç!
    print("üçù –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å –ø–∞—Å—Ç—É")  # –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å—É–ø–∞
    time.sleep(8)
    print("üç∞ –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å —Ç–æ—Ä—Ç")   # –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–∞—Å—Ç—ã

# –ê–°–ò–ù–•–†–û–ù–ù–´–ô –ø–æ–≤–∞—Ä (—É–º–Ω—ã–π)
async def async_chef():
    print("ü•ò –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å —Å—É–ø")
    await asyncio.sleep(10)  # "–ü–æ–∫–∞ —Å—É–ø –≤–∞—Ä–∏—Ç—Å—è, —è –∑–∞–π–º—É—Å—å —á–µ–º-—Ç–æ –¥—Ä—É–≥–∏–º!"
    
    print("üçù –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å –ø–∞—Å—Ç—É")  
    await asyncio.sleep(8)   # "–ü–æ–∫–∞ –ø–∞—Å—Ç–∞ –≥–æ—Ç–æ–≤–∏—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—é —Å—É–ø!"
    
    print("üç∞ –ù–∞—á–∞–ª –≥–æ—Ç–æ–≤–∏—Ç—å —Ç–æ—Ä—Ç")   
    # –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏!
```

**async** - –≥–æ–≤–æ—Ä–∏—Ç: "–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —É–º–µ–µ—Ç –¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤—ã"
**await** - –≥–æ–≤–æ—Ä–∏—Ç: "–Ø —Å–µ–π—á–∞—Å –ø–æ–¥–æ–∂–¥—É, –Ω–æ —Ç—ã –º–æ–∂–µ—à—å –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ –ø–æ–∫–∞!"

## üîÑ Event Loop - "–î–∏—Å–ø–µ—Ç—á–µ—Ä —Ç–∞–∫—Å–∏"

### –ê–Ω–∞–ª–æ–≥–∏—è:
Event Loop - —ç—Ç–æ **–¥–∏—Å–ø–µ—Ç—á–µ—Ä —Ç–∞–∫—Å–∏**, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ –≤–æ–¥–∏—Ç–µ–ª—è–º–∏:

```python
# Event Loop –¥–µ–ª–∞–µ—Ç –≤–æ—Ç —á—Ç–æ:
1. ‚úÖ "–¢–∞–∫—Å–∏—Å—Ç –ê –∂–¥–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞? –ü–µ—Ä–µ—Ö–æ–∂—É –∫ —Ç–∞–∫—Å–∏—Å—Ç—É –ë"
2. ‚úÖ "–¢–∞–∫—Å–∏—Å—Ç –ë –≤–µ–∑–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞? –ü—Ä–æ–≤–µ—Ä—è—é —Ç–∞–∫—Å–∏—Å—Ç–∞ –í"  
3. ‚úÖ "–¢–∞–∫—Å–∏—Å—Ç –ê –¥–æ–µ—Ö–∞–ª? –î–∞—é –µ–º—É –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ!"
4. üîÅ –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–æ –∫—Ä—É–≥—É...

# –ë–µ–∑ Event Loop (–æ–±—ã—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã):
1. ‚ùå "–¢–∞–∫—Å–∏—Å—Ç –ê –∂–¥–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞... –±—É–¥—É –∂–¥–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º"
2. ‚ùå "–ü—Ä–æ—à–ª–∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–∫—Å–∏—Å—Ç—ã - –∏–º –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ–¥–æ–∂–¥–∞—Ç—å"
```

**Event Loop** –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: "–ö–∞–∫–∞—è –∑–∞–¥–∞—á–∞ –≥–æ—Ç–æ–≤–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è? –î–∞–≤–∞–π—Ç–µ –µ—ë!"

## üìû Coroutine (–ö–æ—Ä—É—Ç–∏–Ω–∞) - "–ó–∞–∫–∞–∑ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ"

### –ê–Ω–∞–ª–æ–≥–∏—è:
–ö–æ—Ä—É—Ç–∏–Ω–∞ - —ç—Ç–æ **–∑–∞–∫–∞–∑ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —á–∞—Å—Ç—è–º:

```python
async def restaurant_order():  # –≠—Ç–æ –∫–æ—Ä—É—Ç–∏–Ω–∞ - "–∑–∞–∫–∞–∑"
    print("üìã –ü—Ä–∏–Ω—è–ª–∏ –∑–∞–∫–∞–∑")
    await cook_appetizer()     # "–ì–æ—Ç–æ–≤–∏–º –∑–∞–∫—É—Å–∫—É"
    await cook_main_course()   # "–ì–æ—Ç–æ–≤–∏–º –æ—Å–Ω–æ–≤–Ω–æ–µ –±–ª—é–¥–æ" 
    await cook_dessert()       # "–ì–æ—Ç–æ–≤–∏–º –¥–µ—Å–µ—Ä—Ç"
    return "–ó–∞–∫–∞–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω!"

# –ö–æ—Ä—É—Ç–∏–Ω–∞ ‚â† –æ–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
ordinary_function()  # –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –≤—Å—è
coroutine_function() # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç "–æ–±–µ—â–∞–Ω–∏–µ", –Ω—É–∂–Ω–æ await
```

**–ö–æ—Ä—É—Ç–∏–Ω–∞** - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç "—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É" –∏ "–ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å" –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

## üé™ Task (–ó–∞–¥–∞—á–∞) - "–ë–∏–ª–µ—Ç –≤ –ø–∞—Ä–∫–µ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π"

### –ê–Ω–∞–ª–æ–≥–∏—è:
Task - —ç—Ç–æ **–±–∏–ª–µ—Ç –Ω–∞ –∞—Ç—Ç—Ä–∞–∫—Ü–∏–æ–Ω**, –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç: "–¢—ã –≤ –æ—á–µ—Ä–µ–¥–∏, –º—ã —Ç–µ–±—è –∑–∞–ø—É—Å—Ç–∏–º!"

```python
async def ride_rollercoaster(name):
    print(f"üé¢ {name} —Å—Ç–æ–∏—Ç –≤ –æ—á–µ—Ä–µ–¥–∏")
    await asyncio.sleep(5)  # –ñ–¥–µ—Ç —Å–≤–æ–µ–π –æ—á–µ—Ä–µ–¥–∏
    print(f"üé¢ {name} –∫–∞—Ç–∞–µ—Ç—Å—è!")
    return f"{name} –ø—Ä–æ–∫–∞—Ç–∏–ª—Å—è"

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á = –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤
task1 = asyncio.create_task(ride_rollercoaster("–ê–Ω–Ω–∞"))  # –ë–∏–ª–µ—Ç –ê–Ω–Ω–µ
task2 = asyncio.create_task(ride_rollercoaster("–ë–æ—Ä–∏—Å")) # –ë–∏–ª–µ—Ç –ë–æ—Ä–∏—Å—É
task3 = asyncio.create_task(ride_rollercoaster("–í–∏–∫—Ç–æ—Ä")) # –ë–∏–ª–µ—Ç –í–∏–∫—Ç–æ—Ä—É

# –í—Å–µ —Å—Ç–æ—è—Ç –≤ –æ—á–µ—Ä–µ–¥–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!
await asyncio.gather(task1, task2, task3)
```

**Task** - —ç—Ç–æ "–æ–±–µ—Ä—Ç–∫–∞", –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç Event Loop: "–≠—Ç—É –∫–æ—Ä—É—Ç–∏–Ω—É –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å"

## üèóÔ∏è –ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–æ–≥–∏—è: "–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞"

```python
import asyncio

# –ö–æ—Ä—É—Ç–∏–Ω—ã - —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
async def build_foundation():  # –ó–∞–ª–∏–≤–∫–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞
    print("üèóÔ∏è  –ù–∞—á–∞–ª–∏ –∑–∞–ª–∏–≤–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç...")
    await asyncio.sleep(5)  # –ñ–¥–µ–º –ø–æ–∫–∞ –∑–∞—Å—Ç—ã–Ω–µ—Ç
    print("‚úÖ –§—É–Ω–¥–∞–º–µ–Ω—Ç –≥–æ—Ç–æ–≤!")
    return "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç"

async def build_walls():       # –í–æ–∑–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–µ–Ω  
    print("üß± –ù–∞—á–∞–ª–∏ —Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–µ–Ω—ã...")
    await asyncio.sleep(3)  # –†–∞–±–æ—Ç–∞–µ–º
    print("‚úÖ –°—Ç–µ–Ω—ã –≥–æ—Ç–æ–≤—ã!")
    return "—Å—Ç–µ–Ω—ã"

async def build_roof():        # –ú–æ–Ω—Ç–∞–∂ –∫—Ä—ã—à–∏
    print("üè† –ù–∞—á–∞–ª–∏ –∫—Ä—ã—Ç—å –∫—Ä—ã—à—É...")
    await asyncio.sleep(4)  # –†–∞–±–æ—Ç–∞–µ–º
    print("‚úÖ –ö—Ä—ã—à–∞ –≥–æ—Ç–æ–≤–∞!")
    return "–∫—Ä—ã—à–∞"

async def construction_site():  # Event Loop - –ø—Ä–æ—Ä–∞–±
    print("üë∑ –ü—Ä–æ—Ä–∞–± –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É!")
    
    # –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ - –¥–∞–µ–º –∑–∞–¥–∞–Ω–∏—è —Ä–∞–±–æ—á–∏–º
    task1 = asyncio.create_task(build_foundation())  # –ë—Ä–∏–≥–∞–¥–∞ 1
    task2 = asyncio.create_task(build_walls())       # –ë—Ä–∏–≥–∞–¥–∞ 2  
    task3 = asyncio.create_task(build_roof())        # –ë—Ä–∏–≥–∞–¥–∞ 3
    
    # –ü—Ä–æ—Ä–∞–± –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –±—Ä–∏–≥–∞–¥–∞–º–∏!
    results = await asyncio.gather(task1, task2, task3)
    
    print(f"üéâ –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ü–æ—Å—Ç—Ä–æ–∏–ª–∏: {results}")

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ!
await construction_site()
```

## üí° –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –∫–æ–¥–∞

### –û–±—ã—á–Ω—ã–π (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π) –∫–æ–¥:
```python
def make_breakfast():
    cook_eggs()      # –ñ–¥—É 5 –º–∏–Ω—É—Ç
    toast_bread()    # –ñ–¥—É 3 –º–∏–Ω—É—Ç—ã  
    brew_coffee()    # –ñ–¥—É 4 –º–∏–Ω—É—Ç—ã
    # –ò–¢–û–ì–û: 12 –º–∏–Ω—É—Ç
```

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥:
```python
async def make_breakfast():
    await cook_eggs()      # "–ü–æ–∫–∞ —è–π—Ü–∞ –∂–∞—Ä—è—Ç—Å—è..."
    await toast_bread()    # "...–º–æ–∂–Ω–æ —Ç–æ—Å—Ç —Å–¥–µ–ª–∞—Ç—å..."  
    await brew_coffee()    # "...–∏ –∫–æ—Ñ–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å!"
    # –ò–¢–û–ì–û: ~5 –º–∏–Ω—É—Ç (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!)
```

## üéØ –ö—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞:

| –¢–µ—Ä–º–∏–Ω | –ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ | –ü—Ä–∏–º–µ—Ä |
|--------|------------------|---------|
| **async** | "–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —É–º–µ–µ—Ç –∂–¥–∞—Ç—å" | `async def my_func()` |
| **await** | "–ñ–¥—É, –Ω–æ –º–æ–∂–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å" | `await some_task()` |
| **Coroutine** | "–§—É–Ω–∫—Ü–∏—è —Å –ø–∞—É–∑–æ–π" | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è |
| **Event Loop** | "–î–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á" | –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º |
| **Task** | "–ó–∞–ø—É—â–µ–Ω–Ω–∞—è –∫–æ—Ä—É—Ç–∏–Ω–∞" | `asyncio.create_task()` |

–¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å - —ç—Ç–æ –∫–∞–∫ **—É–º–Ω—ã–π –ø–æ–≤–∞—Ä**, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—Ç–æ–∏—Ç –Ω–∞–¥ –æ–¥–Ω–∏–º –±–ª—é–¥–æ–º, –∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–π –∫—É—Ö–Ω–µ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ! üç≥
## –ü—Ä–æ—Å—Ç–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π

–í–æ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:

```python
import asyncio
import random
import time
from datetime import datetime

class AsyncMessageQueue:
    def __init__(self, max_size=10):
        self.queue = asyncio.Queue(maxsize=max_size)
        self.producers = []
        self.consumers = []
        self.is_running = False
    
    async def producer(self, name, interval=1):
        """–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π"""
        message_id = 0
        while self.is_running:
            try:
                # –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
                await asyncio.sleep(interval)
                
                message = f"–°–æ–æ–±—â–µ–Ω–∏–µ {message_id} –æ—Ç {name}"
                # –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å
                await asyncio.wait_for(
                    self.queue.put((message, datetime.now())),
                    timeout=0.1
                )
                
                print(f"üì® [{name}] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {message}")
                message_id += 1
                
            except asyncio.TimeoutError:
                print(f"‚ö†Ô∏è  [{name}] –û—á–µ—Ä–µ–¥—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º...")
            except Exception as e:
                print(f"‚ùå [{name}] –û—à–∏–±–∫–∞: {e}")
    
    async def consumer(self, name, process_time=2):
        """–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π"""
        while self.is_running:
            try:
                # –ñ–¥—ë–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
                message, timestamp = await asyncio.wait_for(
                    self.queue.get(),
                    timeout=1.0
                )
                
                # –ò–º–∏—Ç–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
                await asyncio.sleep(process_time)
                
                delay = (datetime.now() - timestamp).total_seconds()
                print(f"‚úÖ [{name}] –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: '{message}' | –ó–∞–¥–µ—Ä–∂–∫–∞: {delay:.2f}—Å")
                
                # –ü–æ–º–µ—á–∞–µ–º –∑–∞–¥–∞—á—É –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é
                self.queue.task_done()
                
            except asyncio.TimeoutError:
                # –¢–∞–π–º–∞—É—Ç - –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å
                continue
            except Exception as e:
                print(f"‚ùå [{name}] –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: {e}")
    
    async def monitor(self):
        """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–∏"""
        while self.is_running:
            size = self.queue.qsize()
            print(f"üìä –ú–æ–Ω–∏—Ç–æ—Ä: –í –æ—á–µ—Ä–µ–¥–∏ {size} —Å–æ–æ–±—â–µ–Ω–∏–π")
            await asyncio.sleep(5)
    
    async def run(self, num_producers=2, num_consumers=3, duration=30):
        """–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã"""
        self.is_running = True
        
        print("üöÄ –ó–∞–ø—É—Å–∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏...")
        
        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
        for i in range(num_producers):
            interval = random.uniform(0.5, 2.0)
            task = asyncio.create_task(self.producer(f"Producer-{i}", interval))
            self.producers.append(task)
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
        for i in range(num_consumers):
            process_time = random.uniform(1.0, 3.0)
            task = asyncio.create_task(self.consumer(f"Consumer-{i}", process_time))
            self.consumers.append(task)
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
        monitor_task = asyncio.create_task(self.monitor())
        
        # –ñ–¥–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
        print(f"‚è∞ –†–∞–±–æ—Ç–∞–µ–º {duration} —Å–µ–∫—É–Ω–¥...")
        await asyncio.sleep(duration)
        
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º—É
        await self.stop()
        
        # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
        await monitor_task
    
    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã"""
        print("üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∏—Å—Ç–µ–º—É...")
        self.is_running = False
        
        # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏
        if not self.queue.empty():
            print("‚è≥ –ó–∞–≤–µ—Ä—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å–æ–æ–±—â–µ–Ω–∏–π...")
            await self.queue.join()
        
        # –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏
        for task in self.producers + self.consumers:
            task.cancel()
        
        # –ñ–¥–µ–º –æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞—á
        await asyncio.gather(*self.producers, *self.consumers, return_exceptions=True)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è
async def basic_async_examples():
    """–ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏"""
    
    print("\n" + "="*50)
    print("–ë–ê–ó–û–í–´–ï –ü–†–ò–ú–ï–†–´ –ê–°–ò–ù–•–†–û–ù–ù–û–°–¢–ò")
    print("="*50)
    
    # –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    async def simple_task(name, seconds):
        print(f"–ó–∞–¥–∞—á–∞ '{name}' –Ω–∞—á–∞–ª–∞—Å—å")
        await asyncio.sleep(seconds)
        print(f"–ó–∞–¥–∞—á–∞ '{name}' –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —á–µ—Ä–µ–∑ {seconds}—Å")
        return f"–†–µ–∑—É–ª—å—Ç–∞—Ç {name}"
    
    # –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    results = await asyncio.gather(
        simple_task("A", 2),
        simple_task("B", 1),
        simple_task("C", 3)
    )
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {results}")
    
    # –ü—Ä–∏–º–µ—Ä 2: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
    async async def message_generator(count):
        for i in range(count):
            yield f"–°–æ–æ–±—â–µ–Ω–∏–µ {i}"
            await asyncio.sleep(0.5)
    
    print("–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π:")
    async for message in message_generator(3):
        print(f"  –ü–æ–ª—É—á–µ–Ω–æ: {message}")
    
    # –ü—Ä–∏–º–µ—Ä 3: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    async def limited_task(semaphore, name, duration):
        async with semaphore:
            print(f"–ó–∞–¥–∞—á–∞ '{name}' –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—É (–ª–∏–º–∏—Ç: {semaphore._value})")
            await asyncio.sleep(duration)
            print(f"–ó–∞–¥–∞—á–∞ '{name}' –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å")
    
    semaphore = asyncio.Semaphore(2)  # –ú–∞–∫—Å–∏–º—É–º 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
    tasks = [
        limited_task(semaphore, f"Task-{i}", random.uniform(1, 3))
        for i in range(5)
    ]
    await asyncio.gather(*tasks)

# –£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
class PriorityMessageQueue:
    def __init__(self):
        self.queue = asyncio.PriorityQueue()
    
    async def add_message(self, message, priority=5):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º (–º–µ–Ω—å—à–µ = –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)"""
        await self.queue.put((priority, message))
        print(f"‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ: {message} (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: {priority})")
    
    async def process_messages(self, worker_name):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏"""
        while True:
            try:
                priority, message = await asyncio.wait_for(
                    self.queue.get(), 
                    timeout=2.0
                )
                print(f"üéØ [{worker_name}] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è: {message} (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: {priority})")
                await asyncio.sleep(1)
                self.queue.task_done()
            except asyncio.TimeoutError:
                print(f"‚è∞ [{worker_name}] –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–≤–µ—Ä—à–∞–µ–º...")
                break

async def demo_priority_queue():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏"""
    print("\n" + "="*50)
    print("–û–ß–ï–†–ï–î–¨ –° –ü–†–ò–û–†–ò–¢–ï–¢–ê–ú–ò")
    print("="*50)
    
    pq = PriorityMessageQueue()
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
    messages = [
        ("–í–∞–∂–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ", 1),
        ("–û–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ", 5),
        ("–°—Ä–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ", 0),
        ("–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç", 10),
    ]
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
    for msg, priority in messages:
        await pq.add_message(msg, priority)
    
    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
    await pq.process_messages("Worker-1")

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è–º–∏"""
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã
    await basic_async_examples()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –¥–µ–º–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–π –æ—á–µ—Ä–µ–¥–∏
    await demo_priority_queue()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—á–µ—Ä–µ–¥–µ–π
    print("\n" + "="*50)
    print("–û–°–ù–û–í–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –û–ß–ï–†–ï–î–ï–ô")
    print("="*50)
    
    queue_system = AsyncMessageQueue(max_size=5)
    await queue_system.run(
        num_producers=2,
        num_consumers=3, 
        duration=15  # –†–∞–±–æ—Ç–∞–µ–º 15 —Å–µ–∫—É–Ω–¥ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    )

# –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
async def stress_test():
    """–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã"""
    print("\nüß™ –°–¢–†–ï–°–°-–¢–ï–°–¢ –°–ò–°–¢–ï–ú–´")
    
    stress_queue = AsyncMessageQueue(max_size=3)
    
    # –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏ vs –º–µ–¥–ª–µ–Ω–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏
    await stress_queue.run(
        num_producers=5,
        num_consumers=2,
        duration=10
    )

if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    asyncio.run(main())
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –∑–∞–ø—É—Å–∫ —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞
    # asyncio.run(stress_test())
```

## –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

### 1. –û—Å–Ω–æ–≤—ã async/await
```python
async def my_function():    # –û–±—ä—è–≤–ª–µ–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    result = await some_operation()  # –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    return result
```

### 2. –ü–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
```python
# –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
results = await asyncio.gather(
    task1(),
    task2(),
    task3()
)
```

**–û–∂–∏–¥–∞–Ω–∏–µ —Å —Ç–∞–π–º–∞—É—Ç–æ–º:**
```python
try:
    result = await asyncio.wait_for(slow_operation(), timeout=5.0)
except asyncio.TimeoutError:
    print("–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–Ω—è–ª–∞ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏!")
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:**
```python
semaphore = asyncio.Semaphore(5)  # –ù–µ –±–æ–ª–µ–µ 5 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

async def limited_operation():
    async with semaphore:
        # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
        await do_work()
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `await`** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
2. **–ò–∑–±–µ–≥–∞–π—Ç–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** –≤–Ω—É—Ç—Ä–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `asyncio.create_task()`** –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
4. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è** –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—á–µ—Ä–µ–¥–∏** –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º–∏ –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º–∏

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Python –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π!